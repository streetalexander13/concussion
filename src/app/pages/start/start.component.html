<section class="start">
  <div class="progress-bar">
    <div class="progress" [style.width.%]="(currentExerciseIndex() / 2) * 100"></div>
  </div>

  <ng-container [ngSwitch]="step()">
    <div *ngSwitchCase="'baseline'" class="card fade-in">
      <div class="emoji-icon">🧠</div>
      <h2>What's your baseline today?</h2>
      <p class="subtitle">Rate your current symptoms after resting</p>
      <div class="slider-container">
        <div class="slider-row">
          <input type="range" min="0" max="10" [value]="baseline()" (input)="baseline.set(+$any($event.target).value)" />
        </div>
        <div class="value-display">
          <span class="value-number pulse">{{ baseline() }}</span>
          <span class="value-label">/10</span>
        </div>
        <div class="severity-labels">
          <span>😊 None</span>
          <span>😐 Mild</span>
          <span>😰 Severe</span>
        </div>
      </div>
      <button class="primary btn-large" (click)="confirmBaseline()">
        <span>Continue</span>
        <span class="arrow">→</span>
      </button>
    </div>

    <div *ngSwitchCase="'interstitial'" class="card fade-in">
      <div class="emoji-icon bounce">💪</div>
      <h2>Ready for {{ currentExercise()?.title }}?</h2>
      <p class="subtitle">{{ currentExercise()?.description }}</p>
      <div class="prep-note">Please take a comfortable seated position</div>
      <button class="primary btn-large" (click)="beginExercise()">
        <span>Start Exercise</span>
        <span class="play-icon">▶</span>
      </button>
    </div>

    <div *ngSwitchCase="'exercise'" class="card fade-in exercise-card">
      <h2>{{ currentExercise()?.title }}</h2>
      <p class="desc">{{ currentExercise()?.description }}</p>
      
      <div class="countdown-wrapper" *ngIf="countdown() > 0">
        <div class="countdown pulse">{{ countdown() }}</div>
        <p class="countdown-label">Get ready...</p>
      </div>
      
      <div class="timer-wrapper" *ngIf="countdown() <= 0 && timer() > 0">
        <div class="timer-circle">
          <svg class="timer-svg" viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="45" class="timer-bg" />
            <circle cx="50" cy="50" r="45" class="timer-progress" 
              [style.stroke-dashoffset]="282 * (1 - timer() / 30)" />
          </svg>
          <div class="timer-text">{{ timer() }}<span>s</span></div>
        </div>
        <div class="metronome-indicator" *ngIf="metronomeOn()">
          <span class="pulse">♪</span> Metronome active
        </div>
      </div>

      <div class="symptom-check" *ngIf="countdown() <= 0 && timer() <= 0">
        <p class="check-title">Did your symptoms worsen?</p>
        <div class="check-buttons">
          <button class="check-btn no-btn" (click)="recordSymptom(false)">
            <span class="emoji">😊</span>
            <span>No change</span>
          </button>
          <div class="yes-section">
            <div class="severity-input">
              <label>Severity (1-9)</label>
              <input type="number" min="1" max="9" value="3" #sev class="severity-number" />
            </div>
            <button class="check-btn yes-btn primary" (click)="recordSymptom(true, +sev.value)">
              <span class="emoji">😰</span>
              <span>Yes, worsened</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <div *ngSwitchCase="'done'" class="card fade-in completion-card">
      <div class="emoji-icon bounce">🎉</div>
      <h2>Amazing work!</h2>
      <p class="subtitle">You've completed today's exercises</p>
      <div class="completion-stats">
        <div class="stat">
          <span class="stat-number">{{ currentExerciseIndex() }}</span>
          <span class="stat-label">Exercises</span>
        </div>
        <div class="stat">
          <span class="stat-number">~5</span>
          <span class="stat-label">Minutes</span>
        </div>
      </div>
      <button class="primary btn-large" (click)="goToTrack()">
        <span>View Progress</span>
        <span class="arrow">→</span>
      </button>
    </div>
  </ng-container>
</section>


